!function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=8)}([function(e,t){e.exports=React},function(e,t){e.exports=THREE},function(e,t){e.exports=ReactRedux},function(e,t){e.exports=Redux},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=n(12);!function(e){e.MODEL_HFOV_SET="model.hfov.set",e.MODEL_WIDTH_SET="model.width.set",e.MODEL_HEIGHT_SET="model.height.set",e.MODEL_X_SET="model.x.set",e.MODEL_Y_SET="model.y.set",e.MODEL_PAN_SET="model.pan.set",e.MODEL_TILT_SET="model.tilt.set"}(a=t.Action||(t.Action={})),t.changeHFov=function(e){return i.action(a.MODEL_HFOV_SET,e)},t.changeWidth=function(e){return i.action(a.MODEL_WIDTH_SET,e)},t.changeHeight=function(e){return i.action(a.MODEL_HEIGHT_SET,e)},t.changeX=function(e){return i.action(a.MODEL_X_SET,e)},t.changeY=function(e){return i.action(a.MODEL_Y_SET,e)},t.changePan=function(e){return i.action(a.MODEL_PAN_SET,e)},t.changeTilt=function(e){return i.action(a.MODEL_TILT_SET,e)}},function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(14),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.containerRef=o.createRef(),t}return i(t,e),t.prototype.shouldComponentUpdate=function(e){return e.children!==this.props.children},t.prototype.componentDidMount=function(){this.renderFormula()},t.prototype.componentDidUpdate=function(){this.renderFormula()},t.prototype.render=function(){return o.createElement(this.props.tag,{ref:this.containerRef})},t.prototype.renderFormula=function(){r.render(this.props.children,this.containerRef.current,{displayMode:"div"===this.props.tag})},t}(o.Component);t.Inline=function(e){return o.createElement(l,{tag:"span",children:e.children})},t.Block=function(e){return o.createElement(l,{tag:"div",children:e.children})}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var a=new Uint8Array(16);e.exports=function(){return n(a),a}}else{var i=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),i[t]=e>>>((3&t)<<3)&255;return i}}},function(e,t){for(var n=[],a=0;a<256;++a)n[a]=(a+256).toString(16).substr(1);e.exports=function(e,t){var a=t||0,i=n;return[i[e[a++]],i[e[a++]],i[e[a++]],i[e[a++]],"-",i[e[a++]],i[e[a++]],"-",i[e[a++]],i[e[a++]],"-",i[e[a++]],i[e[a++]],"-",i[e[a++]],i[e[a++]],i[e[a++]],i[e[a++]],i[e[a++]],i[e[a++]]].join("")}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),i=n(9),o=n(3),r=n(2),l=n(10),s=n(13),c=o.createStore(l.default);i.render(a.createElement(r.Provider,{store:c},a.createElement(s.Article,null)),document.getElementById("root"))},function(e,t){e.exports=ReactDOM},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(3),i=n(11),o=a.combineReducers({model:i.default});t.default=o},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(4),o={pan:33.5,tilt:44,hFov:75,width:1920,height:1080,x:1920,y:1080};t.default=function(e,t){switch(void 0===e&&(e=o),t.type){case i.Action.MODEL_HFOV_SET:return a({},e,{hFov:t.payload});case i.Action.MODEL_WIDTH_SET:return a({},e,{width:t.payload,x:Math.min(e.x,t.payload)});case i.Action.MODEL_HEIGHT_SET:return a({},e,{height:t.payload,y:Math.min(e.y,t.payload)});case i.Action.MODEL_X_SET:return a({},e,{x:t.payload});case i.Action.MODEL_Y_SET:return a({},e,{y:t.payload});case i.Action.MODEL_PAN_SET:return a({},e,{pan:t.payload});case i.Action.MODEL_TILT_SET:return a({},e,{tilt:t.payload})}return e}},function(e,t,n){!function(e){"use strict";function t(e,t){return void 0===t&&(t=1),null==e}function n(e){throw void 0===e&&(e=1),new Error("Argument "+e+" is empty.")}function a(e){throw void 0===e&&(e=1),new Error("Argument "+e+' is invalid, it should be an action-creator instance from "typesafe-actions"')}function i(e){return"string"!=typeof e&&"symbol"!=typeof e}function o(e){throw void 0===e&&(e=1),new Error("Argument "+e+" is invalid, it should be an action type of type: string | symbol")}function r(e,t){if(null==e)throw new Error("Argument contains array with empty element at index "+t);if("string"!=typeof e&&"symbol"!=typeof e)throw new Error("Argument contains array with invalid element at index "+t+", it should be of type: string | symbol")}function l(e,t){if(null==e)throw new Error("Argument contains array with empty element at index "+t);if(null==e.getType)throw new Error("Argument contains array with invalid element at index "+t+', it should be an action-creator instance from "typesafe-actions"')}function s(e,o,r,l){return t(e)&&n(1),i(e)&&a(1),{type:e,payload:o,meta:r,error:l}}function c(e,a){t(e)&&n(1),i(e)&&o(1);var r=null!=a?a(e):function(){return{type:e}};return Object.assign(r,{getType:function(){return e},toString:function(){return e}})}e.action=s,e.createAction=function(e,t){var n=null==t?function(){return s(e)}:t(s.bind(null,e));return Object.assign(n,{getType:function(){return e},toString:function(){return e}})},e.createStandardAction=function(e){return t(e)&&n(1),i(e)&&o(1),Object.assign(function(){return c(e,function(e){return function(t,n){return{type:e,payload:t,meta:n}}})},{map:function(t){return c(e,function(e){return function(n,a){return Object.assign(t(n,a),{type:e})}})}})},e.createCustomAction=c,e.createAsyncAction=function(e,t,n){return[e,t,n].forEach(r),Object.assign(function(){return{request:c(e,function(e){return function(t){return{type:e,payload:t}}}),success:c(t,function(e){return function(t){return{type:e,payload:t}}}),failure:c(n,function(e){return function(t){return{type:e,payload:t}}})}})},e.getType=function(e){var i;return t(e)&&n(1),"function"==typeof(i=e)&&"getType"in i||a(1),e.getType()},e.isOfType=function(e,a){t(e)&&n(1);var i=Array.isArray(e)?e:[e];i.forEach(r);var o=function(e){return i.includes(e.type)};return void 0===a?o:o(a)},e.isActionOf=function(e,a){t(e)&&n(1);var i=Array.isArray(e)?e:[e];i.forEach(l);var o=function(e){return i.some(function(t){return e.type===t.getType()})};return void 0===a?o:o(a)},e.createActionDeprecated=function(e,t){var n;if(null!=t){if("function"!=typeof t)throw new Error("second argument is not a function");n=t}else n=function(){return{type:e}};if(null==e)throw new Error("first argument is missing");if("string"!=typeof e&&"symbol"!=typeof e)throw new Error("first argument should be type of: string | symbol");return n},Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){"use strict";var a=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var o,r,l,s,c,h,u,p,m,d,b,f,g,y,E=n(0),v=n(5),w=n(15),x=n(20),O=function(e){return E.createElement("article",null,E.createElement("h1",null,"Пересчет углов PTZ камеры"),E.createElement("p",null,"Имея в качестве входных данных:"),E.createElement("ul",null,E.createElement("li",null,E.createElement(v.Inline,null,"\\phi")," — текущий угол наклона (",E.createElement("em",null,"tilt"),")"),E.createElement("li",null,E.createElement(v.Inline,null,"\\theta")," — текущий угол панорамирования (",E.createElement("em",null,"pan"),")"),E.createElement("li",null,E.createElement(v.Inline,null,"width \\times height")," — ширина и высота текущего изображения"),E.createElement("li",null,E.createElement(v.Inline,null,"\\gamma_h")," — горизонтальный угол обзора"),E.createElement("li",null,E.createElement(v.Inline,null,"x"),", ",E.createElement(v.Inline,null,"y")," — координаты изображения в пределах ",E.createElement(v.Inline,null,"[0;width)")," и ",E.createElement(v.Inline,null,"[0;height)")," соответственно, в которые кликнул пользователь")),E.createElement("p",null,"Рассчитать значения углов ",E.createElement(v.Inline,null,"\\phi^*"),", ",E.createElement(v.Inline,null,"\\theta^*"),", при которых точка с координатами ",E.createElement(v.Inline,null,"[x,y]")," (та, в которую кликнул пользователь) окажется в центре изображения."),E.createElement("h2",null,"tl;dr"),E.createElement(v.Block,null,String.raw(o||(o=a(["\begin{aligned}\n    \tan{alpha} &= \tan{gamma_hover 2} \times {x - width/2 over width/2}\\\n    \tan{\beta} &= \tan{gamma_hover 2} \times {y - height/2 over width/2}\\\n    \tan{\beta'} &= \tan{\beta}cosalpha\\\n    phi^* &= arcsinleft(cosalphacos\beta'cosphicdot(\tan\beta+\tanphi)\right)\\\n    \theta^* &= \theta + arctanleft({\tanalpha over cosphi-\tan\betasinphi}\right)\nend{aligned}"],["\\begin{aligned}\n    \\tan{\\alpha} &= \\tan{\\gamma_h\\over 2} \\times {x - width/2 \\over width/2}\\\\\n    \\tan{\\beta} &= \\tan{\\gamma_h\\over 2} \\times {y - height/2 \\over width/2}\\\\\n    \\tan{\\beta'} &= \\tan{\\beta}\\cos\\alpha\\\\\n    \\phi^* &= \\arcsin\\left(\\cos\\alpha\\cos\\beta'\\cos\\phi\\cdot(\\tan\\beta+\\tan\\phi)\\right)\\\\\n    \\theta^* &= \\theta + \\arctan\\left({\\tan\\alpha \\over \\cos\\phi-\\tan\\beta\\sin\\phi}\\right)\n\\end{aligned}"])))),E.createElement("h2",null,"Расчет"),E.createElement("p",null,"Для начала рассчитаем угол обзора по вертикали:"),E.createElement(v.Block,null,String.raw(r||(r=a(["\n    \tan{gamma_vover 2} = \tan{gamma_hover 2} \times {height over width}\n"],["\n    \\tan{\\gamma_v\\over 2} = \\tan{\\gamma_h\\over 2} \\times {height \\over width}\n"])))),E.createElement("p",null,"Рассчитаем углы обзора части изображения образованной прямоугольником, один угол которого является центром изображения с камеры, второй угол имеет координаты ",E.createElement(v.Inline,null,"[x,y]"),". Обозначим угол по горизонтали ",E.createElement(v.Inline,null,"\\alpha"),", по вертикали — ",E.createElement(v.Inline,null,"\\beta"),"."),E.createElement("p",null,"Для начала рассчитаем смещение точки ",E.createElement(v.Inline,null,"[x,y]")," относительно центра изображения:"),E.createElement(v.Block,null,String.raw(l||(l=a(["\begin{aligned}\n    dx &= x - width/2\\\n    dy &= y - height/2\nend{aligned}"],["\\begin{aligned}\n    dx &= x - width/2\\\\\n    dy &= y - height/2\n\\end{aligned}"])))),E.createElement("p",null,"Зная углы обзора камеры, рассчитаем углы части изображения:"),E.createElement(v.Block,null,String.raw(s||(s=a(["\begin{aligned}\n    \tan{alpha} &= \tan{gamma_hover 2} \times {dx over width/2}\\\n    \tan{\beta} &= \tan{gamma_vover 2} \times {dy over height/2}\nend{aligned}"],["\\begin{aligned}\n    \\tan{\\alpha} &= \\tan{\\gamma_h\\over 2} \\times {dx \\over width/2}\\\\\n    \\tan{\\beta} &= \\tan{\\gamma_v\\over 2} \\times {dy \\over height/2}\n\\end{aligned}"])))),E.createElement("p",null,'Рассмотрим "виртуальную" сферу. Пусть центр сферы находится в точке крепления поворотной камеры. Также представим, что изображение с камеры получается путем пересечения лучей, выпущенных из центра сферы под углами ',E.createElement(v.Inline,null,"\\gamma_h")," и ",E.createElement(v.Inline,null,"\\gamma_v"),". Для простоты расчетов будем полагать, что радиус сферы равен единице."),E.createElement("p",null,"Точка ",E.createElement(v.Inline,null,"C"),", лежащая на поверхности сферы — центр изображения. Координаты точки ",E.createElement(v.Inline,null,"C"),":"),E.createElement(v.Block,null,String.raw(c||(c=a(["\begin{cases}\begin{aligned}\n    x &= cos{phi}sin{\theta}\\\n    y &= sin{phi}\\\n    z &= cos{phi}cos{\theta}\nend{aligned}end{cases}"],["\\begin{cases}\\begin{aligned}\n    x &= \\cos{\\phi}\\sin{\\theta}\\\\\n    y &= \\sin{\\phi}\\\\\n    z &= \\cos{\\phi}\\cos{\\theta}\n\\end{aligned}\\end{cases}"])))),E.createElement("p",null,"Перейдем в систему координат ",E.createElement(v.Inline,null,"X', Y', Z'"),", в которой точка ",E.createElement(v.Inline,null,"C")," будет иметь координаты ",E.createElement(v.Inline,null,"\\{x'=0; y'=0; z'=1\\}"),"."),E.createElement("p",null,"Рассмотрим треугольник ",E.createElement(v.Inline,null,"OCA"),": ",E.createElement(v.Inline,null,"\\angle OCA = 90^\\circ"),", ",E.createElement(v.Inline,null,"OC=1")," (радиус сферы), следовательно ",E.createElement(v.Inline,null,"OA=OC / \\cos\\alpha = 1/\\cos\\alpha")),E.createElement("p",null,"Рассмотрим треугольник ",E.createElement(v.Inline,null,"ODA"),": ",E.createElement(v.Inline,null,"DA=BC=\\tan\\beta")," (т.к. ",E.createElement(v.Inline,null,"ABCD")," — прямоугольник). Отсюда вычисляем: "),E.createElement(v.Block,null,String.raw(h||(h=a(["\n    \tan{\beta'}={DA over OA}=\tan\betacosalpha\n"],["\n    \\tan{\\beta'}={DA \\over OA}=\\tan\\beta\\cos\\alpha\n"])))),E.createElement("p",null,"Рассчитаем координаты точки ",E.createElement(v.Inline,null,"D'"),", которая является проекцией точки ",E.createElement(v.Inline,null,"D")," на сферу. Опустим перпендикуляр из точки ",E.createElement(v.Inline,null,"D'")," на отрезок ",E.createElement(v.Inline,null,"OA"),", ",E.createElement(v.Inline,null,"E")," — точка пересечения этих отрезков. Треугольник ",E.createElement(v.Inline,null,"OED'")," помогает найти координату ",E.createElement(v.Inline,null,"y'=\\sin{\\beta'}")," и ",E.createElement(v.Inline,null,"OE=\\cos{\\beta'}"),". Отрезок ",E.createElement(v.Inline,null,"OE")," лежит в плоскости ",E.createElement(v.Inline,null,"OX'Z'"),", следовательно ",E.createElement(v.Inline,null,"x'=OE\\cdot\\sin\\alpha=\\cos{\\beta'}\\sin\\alpha"),", ",E.createElement(v.Inline,null,"z'=OE\\cdot\\sin\\alpha=\\cos{\\beta'}\\cos\\alpha"),". В итоге получаем:"),E.createElement(v.Block,null,String.raw(u||(u=a(["D'=\n\begin{cases}\begin{aligned}\n    x' &= cos{\beta'}sin{alpha}\\\n    y' &= sin{\beta'}\\\n    z' &= cos{\beta'}cos{alpha}\nend{aligned}end{cases}"],["D'=\n\\begin{cases}\\begin{aligned}\n    x' &= \\cos{\\beta'}\\sin{\\alpha}\\\\\n    y' &= \\sin{\\beta'}\\\\\n    z' &= \\cos{\\beta'}\\cos{\\alpha}\n\\end{aligned}\\end{cases}"])))),E.createElement("p",null,"Перейдем обратно в систему координат ",E.createElement(v.Inline,null,"XYZ"),". Для этого повернем точку ",E.createElement(v.Inline,null,"D'")," сначала вокруг оси ",E.createElement(v.Inline,null,"OX'")," на угол ",E.createElement(v.Inline,null,"\\phi"),", затем вокруг оси ",E.createElement(v.Inline,null,"OY'")," на угол ",E.createElement(v.Inline,null,"\\theta"),". После поворота на ",E.createElement(v.Inline,null,"\\phi")," вокруг оси ",E.createElement(v.Inline,null,"OX'")," получаем следующие координаты:"),E.createElement(v.Block,null,String.raw(p||(p=a(["D'=\n\begin{cases}\begin{alignedat}{2}\n    &x'  &=& cos{\beta'}sinalpha\\\n    &y   &=& sin{\beta'}cosphi + cos{\beta'}cosalphasinphi\\\n    &z^* &=& cos{\beta'}cosalphacosphi - sin{\beta'}sinphi\nend{alignedat}end{cases}"],["D'=\n\\begin{cases}\\begin{alignedat}{2}\n    &x'  &=& \\cos{\\beta'}\\sin\\alpha\\\\\n    &y   &=& \\sin{\\beta'}\\cos\\phi + \\cos{\\beta'}\\cos\\alpha\\sin\\phi\\\\\n    &z^* &=& \\cos{\\beta'}\\cos\\alpha\\cos\\phi - \\sin{\\beta'}\\sin\\phi\n\\end{alignedat}\\end{cases}"])))),E.createElement("p",null,"Рассмотрим поворот вокруг оси ",E.createElement(v.Inline,null,"OY"),":"),E.createElement(v.Block,null,String.raw(m||(m=a(["\begin{aligned}\n    x &= x'cos\theta + z^*sin\theta\\\n    z &= z^*cos\theta - x'sin\theta\nend{aligned}"],["\\begin{aligned}\n    x &= x'\\cos\\theta + z^*\\sin\\theta\\\\\n    z &= z^*\\cos\\theta - x'\\sin\\theta\n\\end{aligned}"])))),E.createElement("p",null,"Точка ",E.createElement(v.Inline,null,"D'")," лежит на поверхности сферы, следовательно :"),E.createElement(v.Block,null,String.raw(d||(d=a(["\nD'=\begin{cases}\begin{alignedat}{2}\n    &x'  &=& cos{phi^*}sin{\theta'}\\\n    &y   &=& sin{phi^*}\\\n    &z^* &=& cos{phi^*}cos{\theta'}\nend{alignedat}end{cases} =\n\begin{cases}\begin{aligned}\n    x &= cos{phi^*}sin{\theta^*}\\\n    y &= sin{phi^*}\\\n    z &= cos{phi^*}cos{\theta^*}\nend{aligned}end{cases}\n"],["\nD'=\\begin{cases}\\begin{alignedat}{2}\n    &x'  &=& \\cos{\\phi^*}\\sin{\\theta'}\\\\\n    &y   &=& \\sin{\\phi^*}\\\\\n    &z^* &=& \\cos{\\phi^*}\\cos{\\theta'}\n\\end{alignedat}\\end{cases} =\n\\begin{cases}\\begin{aligned}\n    x &= \\cos{\\phi^*}\\sin{\\theta^*}\\\\\n    y &= \\sin{\\phi^*}\\\\\n    z &= \\cos{\\phi^*}\\cos{\\theta^*}\n\\end{aligned}\\end{cases}\n"])))),E.createElement("p",null,"Подставляя ",E.createElement(v.Inline,null,"x'")," и ",E.createElement(v.Inline,null,"z^*")," в уравнения выше, получаем:"),E.createElement(v.Block,null,String.raw(b||(b=a(["\begin{alignedat}{2}\n    x &= cosphi^*(sin\theta'cos\theta+cos\theta'sin\theta) &=& cosphi^*sin(\theta+\theta')\\\n    z &= cosphi^*(cos\theta'cos\theta-sin\theta'sin\theta) &=& cosphi^*cos(\theta+\theta')\nend{alignedat}"],["\\begin{alignedat}{2}\n    x &= \\cos\\phi^*(\\sin\\theta'\\cos\\theta+\\cos\\theta'\\sin\\theta) &=& \\cos\\phi^*\\sin(\\theta+\\theta')\\\\\n    z &= \\cos\\phi^*(\\cos\\theta'\\cos\\theta-\\sin\\theta'\\sin\\theta) &=& \\cos\\phi^*\\cos(\\theta+\\theta')\n\\end{alignedat}"])))),E.createElement("p",null,"Упрощая координату ",E.createElement(v.Inline,null,"y"),", получаем:"),E.createElement(v.Block,null,"y = \\cos\\alpha\\cos\\beta'\\cos\\phi(\\tan\\beta+\\tan\\phi)"),E.createElement("div",{style:{display:"none"}},E.createElement(v.Block,null,"\n        y = \\sin\\beta'\\cos\\phi + \\cos\\beta'\\cos\\alpha\\sin\\phi = \\\\\n            \\cos\\beta'\\big(\\tan\\beta'\\cos\\phi + \\cos\\alpha\\sin\\phi\\big) =\n            \\cos\\beta'\\cos\\alpha\\big(\\tan\\beta\\cos\\phi + \\sin\\phi\\big) = \\\\\n            {\\cos\\beta'\\cos\\alpha\\over\\cos\\beta}\\big(\\sin\\beta\\cos\\phi+\\cos\\beta\\sin\\phi\\big)=\n            {\\sin\\beta'\\cos\\alpha\\over\\tan\\beta\\cos\\alpha\\cos\\beta}\\sin(\\beta+\\phi)=\\\\\n            {\\sin\\beta'\\over\\sin\\beta}\\sin(\\beta+\\phi)\n    ")),E.createElement("p",null,"С другой стороны ",E.createElement(v.Inline,null,"y = \\sin\\phi^*"),", откуда получаем:"),E.createElement(v.Block,null,String.raw(f||(f=a(["\n    phi^* = arcsinleft(cosalphacos\beta'cosphi(\tan\beta+\tanphi)\right)\n"],["\n    \\phi^* = \\arcsin\\left(\\cos\\alpha\\cos\\beta'\\cos\\phi(\\tan\\beta+\\tan\\phi)\\right)\n"])))),E.createElement("p",null,"Найдем ",E.createElement(v.Inline,null,"\\theta'")," из следующего соотношения:"),E.createElement(v.Block,null,String.raw(g||(g=a(["\tan\theta' = {x'over z^*} = {\tanalpha over cosphi-\tan\betasinphi}"],["\\tan\\theta' = {x'\\over z^*} = {\\tan\\alpha \\over \\cos\\phi-\\tan\\beta\\sin\\phi}"])))),E.createElement("p",null,"Из соотношения ",E.createElement(v.Inline,null,"x/z=\\tan\\theta^*=\\tan(\\theta+\\theta')")," найдем ",E.createElement(v.Inline,null,"\\theta^*"),":"),E.createElement(v.Block,null,String.raw(y||(y=a(["\n    \theta^* = \theta + arctanleft({\tanalpha over cosphi-\tan\betasinphi}\right)\n"],["\n    \\theta^* = \\theta + \\arctan\\left({\\tan\\alpha \\over \\cos\\phi-\\tan\\beta\\sin\\phi}\\right)\n"])))))};t.Article=function(e){return E.createElement("div",{className:"container-fluid h-100"},E.createElement("div",{className:"row"},E.createElement("div",{className:"col-6"},E.createElement(O,i({},e))),E.createElement("div",{className:"col-6"},E.createElement("div",{style:{height:"100%"}},E.createElement("div",{className:"d-flex flex-column position-sticky",style:{top:0,minHeight:"100vh",maxHeight:"100vh"}},E.createElement(w.PanTiltModel,{className:"d-flex flex-grow-1"}),E.createElement(x.ModelControls,null))))))}},function(e,t){e.exports=katex},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=n(16);t.PanTiltModel=i.connect(function(e,t){return a({},e.model,t)})(o.PanTiltModel)},function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),l=n(1),s=n(17),c=n(18);var h=function(e){function t(t){var n=e.call(this,t)||this;return n.rootDiv=r.createRef(),n.scene=null,n.camera=null,n.renderer=null,n.controls=null,n.rafId=0,n.animate=n.animate.bind(n),n}return i(t,e),t.prototype.shouldComponentUpdate=function(e){return this.updateSceneProps(this.props,e),!1},t.prototype.componentDidUpdate=function(e){this.updateSceneProps(e,this.props)},t.prototype.componentDidMount=function(){var e,t,n,a=this.rootDiv.current;this.scene=new c.Scene(16,this.props.width,this.props.height,this.props.hFov,this.props.pan,this.props.tilt,this.props.x,this.props.y),this.camera=(e=a.clientWidth,t=a.clientHeight,(n=new l.PerspectiveCamera(50,e/t)).position.x=30,n.position.y=-10,n.position.z=30,n.lookAt(0,0,0),n),this.renderer=function(e,t){var n=new l.WebGLRenderer({antialias:!0});return n.setClearColor(16777215),n.setSize(e,t,!1),n}(a.clientWidth,a.clientHeight);var i=this.renderer.domElement;i.style.width="100%",i.style.height="100%",this.controls=new s(this.camera,i),a.appendChild(i),this.animate()},t.prototype.componentWillUnmount=function(){0!==this.rafId&&cancelAnimationFrame(this.rafId)},t.prototype.render=function(){return r.createElement("div",{style:o({},this.props.style||{},{position:"relative"}),className:this.props.className||"",ref:this.rootDiv})},t.prototype.animate=function(){this.rafId=requestAnimationFrame(this.animate),this.controls.update();var e=this.renderer,t=e.domElement,n=this.rootDiv.current,a=n.clientWidth,i=n.clientHeight;a===t.width&&i===t.height||(this.camera.aspect=a/i,this.camera.updateProjectionMatrix(),e.setSize(a,i,!1)),this.scene.onBeforeRender(this.camera.position),e.render(this.scene.getScene(),this.camera)},t.prototype.updateSceneProps=function(e,t){this.scene.updateSceneProps(t.hFov,t.width,t.height,t.x,t.y,t.pan,t.tilt)},t}(r.Component);t.PanTiltModel=h},function(e,t,n){var a=n(1);a.OrbitControls=function(e,t){var n,i,o,r,l;this.object=e,this.domElement=void 0!==t?t:document,this.enabled=!0,this.target=new a.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={LEFT:a.MOUSE.LEFT,MIDDLE:a.MOUSE.MIDDLE,RIGHT:a.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return b.phi},this.getAzimuthalAngle=function(){return b.theta},this.saveState=function(){s.target0.copy(s.target),s.position0.copy(s.object.position),s.zoom0=s.object.zoom},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(c),s.update(),m=p.NONE},this.update=(n=new a.Vector3,i=(new a.Quaternion).setFromUnitVectors(e.up,new a.Vector3(0,1,0)),o=i.clone().inverse(),r=new a.Vector3,l=new a.Quaternion,function(){var e=s.object.position;return n.copy(e).sub(s.target),n.applyQuaternion(i),b.setFromVector3(n),s.autoRotate&&m===p.NONE&&S(2*Math.PI/60/60*s.autoRotateSpeed),b.theta+=f.theta,b.phi+=f.phi,b.theta=Math.max(s.minAzimuthAngle,Math.min(s.maxAzimuthAngle,b.theta)),b.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,b.phi)),b.makeSafe(),b.radius*=g,b.radius=Math.max(s.minDistance,Math.min(s.maxDistance,b.radius)),s.target.add(y),n.setFromSpherical(b),n.applyQuaternion(o),e.copy(s.target).add(n),s.object.lookAt(s.target),!0===s.enableDamping?(f.theta*=1-s.dampingFactor,f.phi*=1-s.dampingFactor,y.multiplyScalar(1-s.dampingFactor)):(f.set(0,0,0),y.set(0,0,0)),g=1,!!(E||r.distanceToSquared(s.object.position)>d||8*(1-l.dot(s.object.quaternion))>d)&&(s.dispatchEvent(c),r.copy(s.object.position),l.copy(s.object.quaternion),E=!1,!0)}),this.dispose=function(){s.domElement.removeEventListener("contextmenu",G,!1),s.domElement.removeEventListener("mousedown",z,!1),s.domElement.removeEventListener("wheel",B,!1),s.domElement.removeEventListener("touchstart",X,!1),s.domElement.removeEventListener("touchend",Z,!1),s.domElement.removeEventListener("touchmove",U,!1),document.removeEventListener("mousemove",H,!1),document.removeEventListener("mouseup",V,!1),window.removeEventListener("keydown",Y,!1)};var s=this,c={type:"change"},h={type:"start"},u={type:"end"},p={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY_PAN:4},m=p.NONE,d=1e-6,b=new a.Spherical,f=new a.Spherical,g=1,y=new a.Vector3,E=!1,v=new a.Vector2,w=new a.Vector2,x=new a.Vector2,O=new a.Vector2,M=new a.Vector2,_=new a.Vector2,P=new a.Vector2,T=new a.Vector2,I=new a.Vector2;function A(){return Math.pow(.95,s.zoomSpeed)}function S(e){f.theta-=e}function D(e){f.phi-=e}var j,C=(j=new a.Vector3,function(e,t){j.setFromMatrixColumn(t,0),j.multiplyScalar(-e),y.add(j)}),L=function(){var e=new a.Vector3;return function(t,n){!0===s.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(s.object.up,e)),e.multiplyScalar(t),y.add(e)}}(),N=function(){var e=new a.Vector3;return function(t,n){var a=s.domElement===document?s.domElement.body:s.domElement;if(s.object.isPerspectiveCamera){var i=s.object.position;e.copy(i).sub(s.target);var o=e.length();o*=Math.tan(s.object.fov/2*Math.PI/180),C(2*t*o/a.clientHeight,s.object.matrix),L(2*n*o/a.clientHeight,s.object.matrix)}else s.object.isOrthographicCamera?(C(t*(s.object.right-s.object.left)/s.object.zoom/a.clientWidth,s.object.matrix),L(n*(s.object.top-s.object.bottom)/s.object.zoom/a.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)}}();function R(e){s.object.isPerspectiveCamera?g/=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*e)),s.object.updateProjectionMatrix(),E=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function k(e){s.object.isPerspectiveCamera?g*=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/e)),s.object.updateProjectionMatrix(),E=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function F(e){O.set(e.clientX,e.clientY)}function z(e){if(!1!==s.enabled){switch(e.preventDefault(),s.domElement.focus?s.domElement.focus():window.focus(),e.button){case s.mouseButtons.LEFT:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===s.enablePan)return;F(e),m=p.PAN}else{if(!1===s.enableRotate)return;!function(e){v.set(e.clientX,e.clientY)}(e),m=p.ROTATE}break;case s.mouseButtons.MIDDLE:if(!1===s.enableZoom)return;!function(e){P.set(e.clientX,e.clientY)}(e),m=p.DOLLY;break;case s.mouseButtons.RIGHT:if(!1===s.enablePan)return;F(e),m=p.PAN}m!==p.NONE&&(document.addEventListener("mousemove",H,!1),document.addEventListener("mouseup",V,!1),s.dispatchEvent(h))}}function H(e){if(!1!==s.enabled)switch(e.preventDefault(),m){case p.ROTATE:if(!1===s.enableRotate)return;!function(e){w.set(e.clientX,e.clientY),x.subVectors(w,v).multiplyScalar(s.rotateSpeed);var t=s.domElement===document?s.domElement.body:s.domElement;S(2*Math.PI*x.x/t.clientHeight),D(2*Math.PI*x.y/t.clientHeight),v.copy(w),s.update()}(e);break;case p.DOLLY:if(!1===s.enableZoom)return;!function(e){T.set(e.clientX,e.clientY),I.subVectors(T,P),I.y>0?R(A()):I.y<0&&k(A()),P.copy(T),s.update()}(e);break;case p.PAN:if(!1===s.enablePan)return;!function(e){M.set(e.clientX,e.clientY),_.subVectors(M,O).multiplyScalar(s.panSpeed),N(_.x,_.y),O.copy(M),s.update()}(e)}}function V(e){!1!==s.enabled&&(document.removeEventListener("mousemove",H,!1),document.removeEventListener("mouseup",V,!1),s.dispatchEvent(u),m=p.NONE)}function B(e){!1===s.enabled||!1===s.enableZoom||m!==p.NONE&&m!==p.ROTATE||(e.preventDefault(),e.stopPropagation(),s.dispatchEvent(h),function(e){e.deltaY<0?k(A()):e.deltaY>0&&R(A()),s.update()}(e),s.dispatchEvent(u))}function Y(e){!1!==s.enabled&&!1!==s.enableKeys&&!1!==s.enablePan&&function(e){var t=!1;switch(e.keyCode){case s.keys.UP:N(0,s.keyPanSpeed),t=!0;break;case s.keys.BOTTOM:N(0,-s.keyPanSpeed),t=!0;break;case s.keys.LEFT:N(s.keyPanSpeed,0),t=!0;break;case s.keys.RIGHT:N(-s.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),s.update())}(e)}function X(e){if(!1!==s.enabled){switch(e.preventDefault(),e.touches.length){case 1:if(!1===s.enableRotate)return;!function(e){v.set(e.touches[0].pageX,e.touches[0].pageY)}(e),m=p.TOUCH_ROTATE;break;case 2:if(!1===s.enableZoom&&!1===s.enablePan)return;!function(e){if(s.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+n*n);P.set(0,a)}if(s.enablePan){var i=.5*(e.touches[0].pageX+e.touches[1].pageX),o=.5*(e.touches[0].pageY+e.touches[1].pageY);O.set(i,o)}}(e),m=p.TOUCH_DOLLY_PAN;break;default:m=p.NONE}m!==p.NONE&&s.dispatchEvent(h)}}function U(e){if(!1!==s.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===s.enableRotate)return;if(m!==p.TOUCH_ROTATE)return;!function(e){w.set(e.touches[0].pageX,e.touches[0].pageY),x.subVectors(w,v).multiplyScalar(s.rotateSpeed);var t=s.domElement===document?s.domElement.body:s.domElement;S(2*Math.PI*x.x/t.clientHeight),D(2*Math.PI*x.y/t.clientHeight),v.copy(w),s.update()}(e);break;case 2:if(!1===s.enableZoom&&!1===s.enablePan)return;if(m!==p.TOUCH_DOLLY_PAN)return;!function(e){if(s.enableZoom){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,a=Math.sqrt(t*t+n*n);T.set(0,a),I.set(0,Math.pow(T.y/P.y,s.zoomSpeed)),R(I.y),P.copy(T)}if(s.enablePan){var i=.5*(e.touches[0].pageX+e.touches[1].pageX),o=.5*(e.touches[0].pageY+e.touches[1].pageY);M.set(i,o),_.subVectors(M,O).multiplyScalar(s.panSpeed),N(_.x,_.y),O.copy(M)}s.update()}(e);break;default:m=p.NONE}}function Z(e){!1!==s.enabled&&(s.dispatchEvent(u),m=p.NONE)}function G(e){!1!==s.enabled&&e.preventDefault()}s.domElement.addEventListener("contextmenu",G,!1),s.domElement.addEventListener("mousedown",z,!1),s.domElement.addEventListener("wheel",B,!1),s.domElement.addEventListener("touchstart",X,!1),s.domElement.addEventListener("touchend",Z,!1),s.domElement.addEventListener("touchmove",U,!1),window.addEventListener("keydown",Y,!1),this.update()},a.OrbitControls.prototype=Object.create(a.EventDispatcher.prototype),a.OrbitControls.prototype.constructor=a.OrbitControls,Object.defineProperties(a.OrbitControls.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}}),e.exports=t.default=a.OrbitControls},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1),i=n(1),o=n(19),r=14540253,l=0,s=new a.Vector3(0,0,0);function c(e,t,n){var a=Math.atan2(n,e),i=Math.atan2(t,e),o=Math.atan2(n,Math.sqrt(t*t+e*e));return[0,0,0,0,0,e,t,0,e,t,n,e,0,n,e,e*Math.sin(i),0,e*Math.cos(i),e*Math.sin(i)*Math.cos(o),e*Math.sin(o),e*Math.cos(i)*Math.cos(o),0,e*Math.sin(a),e*Math.cos(a)]}var h=[1,2,2,3,3,4,4,1,2,5,4,7,3,6,1,0,5,0,6,0,7,0];function u(e,t){var n=e*Math.cos(t),i=new a.EllipseCurve(0,0,n,n,0,2*Math.PI,!1,0),o=e*Math.sin(t);return i.getPoints(60).map(function(e){return new a.Vector3(e.x,o,e.y)})}function p(e,t,n){void 0===t&&(t=1),void 0===n&&(n=0);var i=function(e,t){void 0===t&&(t=1);var n=Math.PI/t,i=new a.EllipseCurve(0,0,e,e,Math.PI/2,Math.PI/2+2*Math.PI,!1,0).getPoints(60).map(function(e){return new a.Vector3(e.x,e.y,0)}),o=[];o.push.apply(o,i),i.shift();for(var r=new a.Vector3(0,1,0),l=1;l<t;++l)for(var s=0,c=i;s<c.length;s++){var h=c[s].clone().applyAxisAngle(r,n*l);o.push(h)}return o}(e,t),o=function(e,t){void 0===t&&(t=0);var n=[];n.push(u(e,0));for(var a=0;a<t;++a){var i=Math.asin(e*(a+1)/(e*(t+1)));n.push(u(e,i)),n.push(u(e,-i))}return n}(e,n),l=[];l.push({startVertex:0,count:i.length});for(var s=i.length,c=0,h=o.length;c<h;++c){var p=o[c].length;i=i.concat(o[c]),l.push({startVertex:s,count:p}),s+=p}var m=[new a.LineBasicMaterial({color:r}),new a.LineBasicMaterial({color:10066329})],d=(new a.BufferGeometry).setFromPoints(i);d.addGroup(l[0].startVertex,l[0].count,0),d.addGroup(l[1].startVertex,l[1].count,1);for(c=0,h=l.length;c<h;++c)d.addGroup(l[c].startVertex,l[c].count,0);return new a.Line(d,m)}function m(e,t){var n=e.clone().normalize(),i=e.clone().cross(t).normalize(),o=i.clone().cross(n).normalize();return(new a.Matrix4).makeBasis(n,o,i)}function d(e,t,n,i){var o=m(n,i),r=n.angleTo(i);return new a.EllipseCurve(0,0,e,e,0,r,!1,0).getPoints(t).map(function(e){return new a.Vector3(e.x,e.y,0).applyMatrix4(o)})}function b(e,t,n){for(var o=function(e){return(new a.Vector3).fromBufferAttribute(t,e)},r=function(e,t){return m(e.add(t),t)},l=0,s=[{text:"O",position:o(0)},{text:"C",position:o(1)},{text:"A",position:o(2)},{text:"D",position:o(3)},{text:"B",position:o(4)},{text:"D'",position:o(6)},{text:"α",position:new i.Vector3(n/4,-.4,0),plane:r(o(1),o(2))},{text:"β",position:new i.Vector3(n/4,-.4,0),plane:r(o(1),o(4))},{text:"β'",position:new i.Vector3(n/4,-.4,0),plane:r(o(2),o(3))}];l<s.length;l++){var c=s[l],h=e.labels[c.text].mesh;c.plane&&(h.matrix.identity(),c.position.applyMatrix4(c.plane),h.applyMatrix(c.plane)),h.position.copy(c.position)}}function f(e,t){var n=function(e){return(new a.Vector3).fromBufferAttribute(t,e)},i=d(e/3,20,n(4),n(1)),o=d(e/3,20,n(1),n(2)),r=d(e/3,20,n(2),n(3)),s=i.concat(o).concat(r),c=new a.LineBasicMaterial({color:l}),h=(new a.BufferGeometry).setFromPoints(s);return new a.Line(h,c)}var g=function(){function e(e,t,n,i,r,l,s,h){var u=this;this.scene=new a.Scene,this.radius=e,this.width=t,this.height=n,this.hFov=i/180*Math.PI,this.pan=r/180*Math.PI,this.tilt=l/180*Math.PI,this.x=s,this.y=h;var m=this.calcDxDy(),d=m.dx,g=m.dy;this.pointPositions=new a.Float32BufferAttribute(c(this.radius,d,g),3),this.scene.add(p(e,18,6)),this.plane=this.createPlane(),this.labels=function(){for(var e={labels:{}},t=new a.Font(o),n=new a.MeshBasicMaterial({color:0,fog:!1}),i=0,r=["O","C","A","D","B","D'","α","β","β'"];i<r.length;i++){var l=r[i],s=new a.TextBufferGeometry(l,{font:t,size:1,height:0});e.labels[l]={mesh:new a.Mesh(s,n)}}return e}(),b(this.labels,this.pointPositions,this.radius),Object.keys(this.labels.labels).forEach(function(e){u.plane.add(u.labels.labels[e].mesh)}),this.angles=f(this.radius,this.pointPositions),this.plane.add(this.angles),this.plane.rotateOnWorldAxis(new a.Vector3(1,0,0),this.tilt),this.plane.rotateOnWorldAxis(new a.Vector3(0,1,0),this.pan),this.scene.add(this.plane)}return e.prototype.getScene=function(){return this.scene},e.prototype.getRadius=function(){return this.radius},e.prototype.onBeforeRender=function(e){var t=e.distanceTo(s);null===this.scene.fog?this.scene.fog=new a.Fog(15790320,t-this.radius,t+this.radius):(this.scene.fog.near=t-this.radius,this.scene.fog.far=t+this.radius)},e.prototype.updateSceneProps=function(e,t,n,i,o,r,l){e=e/180*Math.PI,r=r/180*Math.PI,l=l/180*Math.PI;var s=!1,h=!1;if(this.hFov===e&&this.width===t&&this.height===n&&this.x===i&&this.y===o||(this.hFov=e,this.width=t,this.height=n,this.x=i,this.y=o,s=!0,h=!0),this.pan===r&&this.tilt===l||(this.pan=r,this.tilt=l,h=!0),!0===s){var u=this.calcDxDy(),p=u.dx,m=u.dy,d=c(this.radius,p,m);this.pointPositions.copyArray(d),this.pointPositions.needsUpdate=!0,b(this.labels,this.pointPositions,this.radius),this.plane.remove(this.angles),this.angles=f(this.radius,this.pointPositions),this.plane.add(this.angles)}!0===h&&(this.plane.rotation.x=0,this.plane.rotation.y=0,this.plane.rotation.z=0,this.plane.rotateOnWorldAxis(new a.Vector3(1,0,0),l),this.plane.rotateOnWorldAxis(new a.Vector3(0,1,0),r))},e.prototype.calcDxDy=function(){var e=Math.tan(this.hFov/2),t=e*(2*this.x-this.width)/this.width,n=e*(this.height-2*this.y)/this.width;return{dx:this.radius*t,dy:this.radius*n}},e.prototype.createPlane=function(){return function(e,t){var n=new a.BufferGeometry;n.setIndex(h),n.addAttribute("position",t);for(var i=new Float32Array(t.count),o=0;o<t.count;++o)i[o]=0==o?0:e;n.addAttribute("lineDistance",new a.BufferAttribute(i,1)),n.addGroup(0,14,0),n.addGroup(14,8,1);var r=[new a.LineBasicMaterial({color:16711680}),new a.LineDashedMaterial({color:0,linewidth:1,scale:2,dashSize:1,gapSize:.5})];return new a.LineSegments(n,r)}(this.radius,this.pointPositions)},e}();t.Scene=g},function(e){e.exports={glyphs:{A:{ha:1042,x_min:0,x_max:0,o:"m 814 4 b 614 0 761 4 664 4 l 614 43 b 729 85 651 43 729 43 b 725 104 729 90 726 99 l 651 317 l 308 317 l 244 135 b 242 114 243 132 242 118 b 346 43 242 78 276 43 l 346 0 l 186 4 l 44 0 l 44 43 b 200 136 119 44 175 65 l 488 967 b 521 994 494 986 499 994 b 553 967 543 994 546 985 l 853 99 b 971 43 868 53 888 43 l 996 43 l 996 0 m 479 811 l 324 360 l 636 360 "},B:{ha:983,x_min:0,x_max:0,o:"m 904 254 b 594 0 904 124 779 0 l 50 0 l 50 43 l 83 43 b 193 108 190 43 193 58 l 193 840 b 83 906 193 890 190 906 l 50 906 l 50 949 l 558 949 b 867 714 739 949 867 835 b 636 496 867 611 771 522 b 904 254 790 479 904 375 m 732 714 b 549 906 732 788 683 906 l 376 906 b 308 850 311 906 308 896 l 308 508 l 510 508 b 732 714 664 508 732 625 m 765 256 b 569 478 765 349 707 478 l 308 478 l 308 99 b 376 43 308 53 311 43 l 550 43 b 765 256 693 43 765 157 "},C:{ha:1003,x_min:0,x_max:0,o:"m 924 324 b 561 -31 924 163 788 -31 b 78 475 303 -31 78 188 b 561 979 78 758 301 979 b 817 860 694 979 765 910 l 886 963 b 908 979 897 979 903 979 b 924 946 924 979 924 969 l 924 617 b 901 583 924 588 924 583 b 879 607 882 583 882 588 b 576 936 851 810 728 936 b 221 474 492 936 221 889 b 578 13 221 60 493 13 b 889 325 729 13 878 126 b 906 347 890 339 890 347 b 924 324 924 347 924 338 "},D:{ha:1061,x_min:0,x_max:0,o:"m 982 467 b 557 0 982 206 790 0 l 49 0 l 49 43 l 82 43 b 192 108 189 43 192 58 l 192 840 b 82 906 192 890 189 906 l 49 906 l 49 949 l 557 949 b 982 467 794 949 982 731 m 843 467 b 771 776 843 575 831 694 b 518 906 700 875 604 906 l 379 906 b 311 850 314 906 311 896 l 311 99 b 379 43 311 53 314 43 l 519 43 b 767 161 660 43 739 124 b 843 467 817 229 843 313 "},O:{ha:1081,x_min:0,x_max:0,o:"m 1001 471 b 539 -31 1001 190 792 -31 b 78 471 292 -31 78 186 b 539 979 78 757 290 979 b 1001 471 792 979 1001 754 m 858 490 b 539 944 858 846 660 944 b 221 490 424 944 221 850 b 540 6 221 128 407 6 b 858 490 668 6 858 122 "},"'":{ha:386,x_min:0,x_max:0,o:"m 211 588 l 175 588 l 144 931 b 193 979 142 958 165 979 b 242 931 221 979 244 958 "},"α":{ha:890,x_min:0,x_max:0,o:"m 885 83 b 793 -15 890 61 867 -15 b 638 101 731 -15 674 28 b 374 -15 553 17 461 -15 b 90 219 232 -15 122 90 b 365 614 40 415 175 614 b 668 328 468 614 614 546 l 690 242 b 757 517 735 324 754 429 b 771 546 758 542 757 546 b 790 532 786 546 790 532 b 713 206 790 532 803 369 b 711 157 703 189 704 186 b 789 15 719 124 746 15 b 850 83 789 15 842 15 b 865 97 851 93 856 97 b 885 83 874 97 882 93 m 622 138 b 581 293 614 161 594 242 b 371 583 554 401 508 583 b 214 456 322 583 254 557 b 206 167 188 385 189 235 b 368 15 228 78 285 15 b 622 138 424 15 528 31 "},"β":{ha:775,x_min:0,x_max:0,o:"m 675 258 b 586 64 674 185 640 114 b 369 -15 526 11 449 -15 b 153 121 275 -15 197 40 l 154 -260 b 142 -269 154 -265 149 -269 l 135 -269 b 117 -253 126 -269 119 -264 l 118 601 b 364 981 118 790 197 981 b 542 911 429 981 493 956 b 611 797 575 881 600 840 b 617 746 615 781 617 764 b 544 585 617 683 589 626 b 510 557 533 574 521 565 b 585 497 538 542 561 521 b 664 347 622 454 650 403 b 675 258 671 319 674 289 m 581 265 b 568 386 581 306 578 347 b 524 482 558 421 546 453 b 469 536 508 504 490 522 b 369 518 438 524 404 518 b 256 551 321 518 264 518 l 254 561 b 363 599 254 599 313 599 b 461 581 396 599 431 592 b 490 607 471 588 482 597 b 535 753 524 647 535 700 b 526 822 535 776 532 800 b 492 893 519 849 510 872 b 369 949 461 929 417 949 b 153 594 217 949 154 769 l 154 258 b 163 190 154 235 157 213 b 363 15 188 92 263 15 b 524 88 424 15 483 42 b 581 265 567 136 581 201 m 421 560 b 369 567 406 564 388 567 b 289 554 336 567 290 567 b 363 549 289 549 332 549 b 421 560 382 549 403 553 "},"φ":{ha:890,x_min:0,x_max:0,o:"m 819 422 b 485 -15 875 203 715 -15 b 438 -12 461 -15 450 -14 b 453 -267 450 -210 454 -256 b 410 -303 447 -299 417 -303 b 360 -264 396 -303 368 -294 b 360 -236 358 -257 360 -254 l 376 -3 b 69 264 218 32 101 133 b 131 599 36 397 92 599 b 151 585 144 599 150 590 b 144 567 151 585 153 579 b 101 279 85 471 92 318 b 381 74 126 179 224 101 b 614 614 396 344 413 614 b 819 422 718 614 793 531 m 789 392 b 619 533 772 458 715 533 b 422 222 496 533 421 400 l 432 72 b 451 67 433 68 435 67 b 476 65 463 65 465 65 b 789 392 690 65 828 235 "}},familyName:"Latin Modern Math",ascender:1119,descender:-269,underlinePosition:-306,underlineThickness:56,boundingBox:{yMin:-4250,xMin:-1447,yMax:4944,xMax:5669},resolution:1e3,original_font_information:{format:0,copyright:"Copyright 2012--2014 for Latin Modern Math OTF by B. Jackowski, P. Strzelczyk and P. Pianowski (on behalf of TeX users groups). This work is released under the GUST Font License -- see http://tug.org/fonts/licenses/GUST-FONT-LICENSE.txt for details.",fontFamily:"Latin Modern Math",fontSubfamily:"Regular",uniqueID:"1.959",fullName:"LatinModernMath-Regular",version:"Version 1.959",postScriptName:"LatinModernMath-Regular",trademark:"Please refer to the Copyright section for the font trademark attribution notices.",preferredFamily:"Latin Modern Math",preferredSubfamily:"Regular"},cssFontWeight:"normal",cssFontStyle:"normal"}},function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var i=n(2),o=n(4),r=n(21);t.ModelControls=i.connect(function(e){return a({},e.model)},{changeHFov:o.changeHFov,changeWidth:o.changeWidth,changeHeight:o.changeHeight,changeX:o.changeX,changeY:o.changeY,changeTilt:o.changeTilt,changePan:o.changePan})(r.ModelControls)},function(e,t,n){"use strict";var a,i=this&&this.__extends||(a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var o=n(0),r=n(22),l=n(25),s=n(5),c=function(e){var t=e.tilt*Math.PI/180,n=Math.tan(e.hFov*Math.PI/360),a=n*(2*e.x-e.width)/e.width,i=n*(2*e.y-e.height)/e.width,o=1/Math.sqrt(1+a*a),r=i*o,l=1/Math.sqrt(1+r*r),s=Math.cos(t),c=Math.tan(t),h=Math.asin(o*l*s*(i+c)),u=Math.atan2(a,s*(1-i*c)),p=e.pan+180*u/Math.PI;return p>=360?p-=360:p<0&&(p+=360),{newTilt:180*h/Math.PI,newPan:p}},h=function(e){function t(t){var n=e.call(this,t)||this;return n.id=""+r.v4(),n.onChange=n.onChange.bind(n),n}return i(t,e),t.prototype.onChange=function(e){this.props.onChange(e.target.valueAsNumber)},t.prototype.render=function(){return o.createElement(o.Fragment,null,o.createElement("label",{htmlFor:this.id},this.props.children),o.createElement("input",{type:"range",className:"custom-range",min:this.props.min,max:this.props.max,step:this.props.step,id:this.id,value:this.props.value,onChange:this.onChange}))},t}(o.PureComponent),u=function(e){function t(t){var n=e.call(this,t)||this;return n.newAngles=l.default(c),n.changeX=n.changeX.bind(n),n.changeY=n.changeY.bind(n),n}return i(t,e),t.prototype.changeX=function(e){return this.props.changeX(Math.min(e,this.props.width))},t.prototype.changeY=function(e){return this.props.changeY(Math.min(e,this.props.height))},t.prototype.render=function(){var e=this.props,t=e.hFov,n=e.width,a=e.height,i=e.x,r=e.y,l=e.pan,c=e.tilt,u=this.newAngles(this.props),p=u.newTilt,m=u.newPan;return o.createElement("form",{className:"pb-3"},o.createElement("div",{className:"row"},o.createElement("div",{className:"col"},o.createElement(h,{min:1,max:90,step:.1,onChange:this.props.changeHFov,value:t},"Horizontal FOV ",t,"°")),o.createElement("div",{className:"col"},o.createElement(h,{min:0,max:360,step:.1,onChange:this.props.changePan,value:l},"Pan ",l,"°")),o.createElement("div",{className:"col"},o.createElement(h,{min:-90,max:90,step:.1,onChange:this.props.changeTilt,value:c},"Tilt ",c,"°"))),o.createElement("div",{className:"row"},o.createElement("div",{className:"col"},o.createElement(h,{min:1,max:2048,step:1,onChange:this.props.changeWidth,value:n},"Width ",n,"px")),o.createElement("div",{className:"col"},o.createElement(h,{min:1,max:2048,step:1,onChange:this.props.changeHeight,value:a},"Height ",a,"px"))),o.createElement("div",{className:"row"},o.createElement("div",{className:"col"},o.createElement(h,{min:1,max:2048,step:1,onChange:this.changeX,value:Math.min(i,n)},"X ",i,"px")),o.createElement("div",{className:"col"},o.createElement(h,{min:1,max:2048,step:1,onChange:this.changeY,value:Math.min(r,a)},"Y ",r,"px"))),o.createElement("div",{className:"row"},o.createElement("div",{className:"col"},o.createElement(s.Inline,null,"\\theta^*")," ",Number(m).toFixed(3),"°"),o.createElement("div",{className:"col"},o.createElement(s.Inline,null,"\\phi^*")," ",Number(p).toFixed(3),"°")))},t}(o.PureComponent);t.ModelControls=u},function(e,t,n){var a=n(23),i=n(24),o=i;o.v1=a,o.v4=i,e.exports=o},function(e,t,n){var a,i,o=n(6),r=n(7),l=0,s=0;e.exports=function(e,t,n){var c=t&&n||0,h=t||[],u=(e=e||{}).node||a,p=void 0!==e.clockseq?e.clockseq:i;if(null==u||null==p){var m=o();null==u&&(u=a=[1|m[0],m[1],m[2],m[3],m[4],m[5]]),null==p&&(p=i=16383&(m[6]<<8|m[7]))}var d=void 0!==e.msecs?e.msecs:(new Date).getTime(),b=void 0!==e.nsecs?e.nsecs:s+1,f=d-l+(b-s)/1e4;if(f<0&&void 0===e.clockseq&&(p=p+1&16383),(f<0||d>l)&&void 0===e.nsecs&&(b=0),b>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");l=d,s=b,i=p;var g=(1e4*(268435455&(d+=122192928e5))+b)%4294967296;h[c++]=g>>>24&255,h[c++]=g>>>16&255,h[c++]=g>>>8&255,h[c++]=255&g;var y=d/4294967296*1e4&268435455;h[c++]=y>>>8&255,h[c++]=255&y,h[c++]=y>>>24&15|16,h[c++]=y>>>16&255,h[c++]=p>>>8|128,h[c++]=255&p;for(var E=0;E<6;++E)h[c+E]=u[E];return t||r(h)}},function(e,t,n){var a=n(6),i=n(7);e.exports=function(e,t,n){var o=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var r=(e=e||{}).random||(e.rng||a)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t)for(var l=0;l<16;++l)t[o+l]=r[l];return t||i(r)}},function(e,t,n){"use strict";function a(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}n.r(t),t.default=function(e,t){var n;void 0===t&&(t=a);var i,o=[],r=!1;return function(){for(var a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return r&&n===this&&t(l,o)?i:(i=e.apply(this,l),r=!0,n=this,o=l,i)}}}]);